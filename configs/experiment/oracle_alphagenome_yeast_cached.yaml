# Default config for yeast AlphaGenome head sweep (no_shift / cached mode)
# Override head_arch and output_dir per job.

task_mode: yeast
head_arch: boda-flatten-512-512
head_name: ag_yeast_head
num_tracks: 18            # 18 expression bins

yeast_data_path: data/yeast
weights_path: checkpoints/alphagenome-jax-all_folds-v1
context_mode: alphagenome384
gpu: 0

# Training
epochs: 100
seed: 42
wandb_mode: online

batch_size: 128
num_workers: 4
max_seq_len: 384
lr: 0.0001
weight_decay: 0.0001
save_full_model: false
include_pool: true

# Augmentation / caching mode ('no_shift' recommended for arch search)
aug_mode: no_shift
cache_dir: null           # null â†’ <output_dir>/embedding_cache (shared across runs)

# Head regularization
dropout_rate: 0.1

# LR schedule
lr_schedule: plateau
lr_plateau_patience: 5
lr_plateau_factor: 0.5

# Early stopping
early_stop_patience: 15

output_dir: outputs/ag_yeast_sweep/flatten_512_512
